# 企画・要件定義_フェーズ2 📝

<aside>
3Dモデル共有から記事中心のクリエイティブコンテンツプラットフォーム「カタマリ」（旧：カタワク）の発展計画です
</aside>

- **🎯 目的の明確化**
    - 👩‍💻 ターゲットユーザー
    - 若い個人クリエイター、アーティストを中心に
    - 20-30代の3Dデザインに関心がある創作者
    - SNSで作品を発信したいクリエイティブな層
    - かわいいもの・ユニークなアイテムに興味がある人
    - 🔍 解決する問題
    - 3D作品の「制作過程」や「ノウハウ」を共有できるプラットフォームの不足
    - 日本語で利用できる3D創作コミュニティが少ない状況
    - SNS発信に適した「映え」や「ハック」を生み出す場所の欠如
    - 💡 コンセプト
    - サービス名：「カタマリ」（旧：カタワク）
    - 3Dプリンターの価値を「実用性」から「創作体験」「知識共有」「コミュニティ」にシフト
    - 記事を中心とした知識・経験・制作物の共有プラットフォーム
    - キャッチフレーズ：「3Dプリントで、共有する喜び」
- **📋 要件の洗い出し**
    - Must（必須要件）
    - 記事投稿・閲覧機能
    - 画像・動画のアップロード機能
    - 制作ファイル一式のアップロード・ダウンロード機能
    - 最低1つのSTLファイルを含むバリデーション
    - Googleアカウント連携による簡単認証
    - supabaseを使った簡単なDBシステム
    - シンプルなユーザーインターフェース
    - 検索機能
    - 基本的なユーザープロフィール（名前、アイコン）
    - SNS共有機能
    - Google Analytics 4によるトラッキング
    - 3Dモデルプレビュー機能（記事内埋め込み対応）
    - セキュリティ対策の強化
    - レスポンシブデザイン（PC/タブレット/スマホ対応）
- **💰 収益化戦略**
    - 短期（リリース〜売却まで）
    - 3Dプリンター関連会社への売却
    - クリエイターエコノミーへの参入
    - 優良コンテンツ制作者の囲い込み
    - 長期（売却後）
    - 会員サブスクリプションモデル（売却先での展開）
    - 広告塔としての事業全体の経費削減効果
    - クリエイターマーケットプレイス化
    - プレミアムコンテンツの有料提供
- **⏱️ スケジュール作成**
    - Phase 2: Site Reconstruction（サイト再構築）
    - ドメイン変更: katawaku から katamari.jp へ
    - コンセプト拡大: 3Dモデル専門から体験の共有プラットフォームへ
    - Phase 2.1: 市場優位性の確立
    - 拡散性重視のUIデザイン
    - SNS連携機能の強化
    - 魅力的なオリジナルコンテンツの提供
    - Phase 2.2: シェアラビリティの向上
    - SNSシェア機能の実装
    - シェアしたくなるUIの実装
    - Phase 2.3: 運用テスト
    - ユーザーエクスペリエンスの評価
    - 技術的問題の確認と修正
    - データ収集と分析
- **🔄 開発アプローチ**
    - シンプルさを重視
    - 最小限の機能でスピーディにリリース
    - 1人で運営可能な規模を維持
    - 外部サービスを活用して開発工数削減
    - 技術スタック
    - 認証: Googleアカウント連携
    - バックエンド: Supabase
    - フロントエンド: Next.js 14
    - デプロイ: Vercel
    - アナリティクス: Google Analytics 4
    - リッチテキストエディタ: TipTap
    - 3Dモデルビューア: Three.js
- **🛡️ セキュリティ対策**
    - SSL/TLS暗号化によるデータ保護
    - SupabaseのRLS（Row Level Security）の活用
    - 入力値の検証とサニタイズ
    - アップロードファイルの種類制限と検証
    - 認証・認可の厳格な管理
    - ログ機能の実装によるセキュリティ監視
    - 定期的なセキュリティレビュー 

# カタマリ：記事中心コンテンツプラットフォームの実装計画

## 📝 プラットフォーム概要

- **目的**
  - 創作体験・ノウハウを記事として共有できるプラットフォーム
  - 記事と合わせて制作に必要なファイル一式をダウンロード可能に
  - 画像・動画による視覚的な説明と3Dファイルの併用
  - クリエイターの知識・経験・ノウハウの共有を促進
  - コミュニティの活性化と滞在時間の増加
  - 単なるモデル共有ではなく、作品に対する「ストーリー」や「プロセス」を重視
  - 3Dプリント初心者から上級者まで幅広いユーザーをサポート
  - 「作る喜び」と「共有する喜び」の両方を提供

- **コンテンツ構造**
  - **記事コンテンツ**: テキスト本文と埋め込みメディア（説明用）
  - **添付ファイル一式**: 実際の制作に必要なファイル（STL必須）
  - **明確な区別**: 記事内の埋め込みメディアとダウンロード用ファイル一式は別々に管理
  - **用途の違い**: 埋め込みメディアは説明のため、ファイル一式は実際の制作のため
  - **コンテンツタイプ**:
    - チュートリアル型（制作工程の解説）
    - ショーケース型（完成作品のプレゼンテーション）
    - ハック型（既存製品の改良・カスタマイズ）
    - コンセプト型（アイデアや発想の共有）
  - **アクセス解析（閲覧数、ダウンロード数）**

- **主要機能**
  - リッチテキストエディタによる記事作成
  - 画像/動画のアップロード機能
  - 制作ファイル一式（STLファイル必須）のアップロード・ダウンロード
  - フォルダ構造を維持したファイル管理
  - ファイル構造のプレビュー表示
  - STL/OBJファイルの3Dプレビュー
  - 下書き保存機能
  - 公開/非公開設定

## 💾 データベース設計

- **新テーブル：articles**
  - id: UUID (PK)
  - user_id: UUID (FK to users)
  - title: TEXT
  - content: JSON (リッチテキスト用)
  - summary: TEXT
  - hero_image_id: UUID (FK to article_media)
  - status: TEXT ('draft', 'published')
  - created_at: TIMESTAMP
  - updated_at: TIMESTAMP
  - published_at: TIMESTAMP
  - view_count: INTEGER
  - download_count: INTEGER
  - has_stl_file: BOOLEAN

- **新テーブル：article_media**
  - id: UUID (PK)
  - article_id: UUID (FK to articles)
  - user_id: UUID (FK to users)
  - filename: TEXT
  - filesize: INTEGER
  - media_type: TEXT ('image', 'video', 'stl', 'obj')
  - media_role: TEXT ('hero', 'content')
  - storage_path: TEXT
  - width: INTEGER
  - height: INTEGER
  - duration: INTEGER (動画の場合)
  - model_preview_settings: JSONB (3Dモデル用の表示設定)
  - created_at: TIMESTAMP
  - public_url: TEXT

- **新テーブル：files**
  - id: UUID (PK)
  - article_id: UUID (FK to articles)
  - user_id: UUID (FK to users)
  - filename: TEXT
  - filesize: INTEGER
  - filetype: TEXT
  - filepath: TEXT
  - relative_path: TEXT
  - parent_folder: TEXT
  - storage_path: TEXT
  - is_stl: BOOLEAN
  - is_obj: BOOLEAN
  - created_at: TIMESTAMP

## 📱 UI/UX設計

- **記事投稿フロー**
  1. 「記事を書く」ボタンからエディタ画面へ
  2. タイトル入力
  3. Hero画像のアップロード（専用セクション）
  4. リッチテキストエディタでコンテンツ作成
  5. コンテンツ内に画像・動画・3Dモデルを挿入（article_media, role='content'）
  6. 別セクションで制作ファイル一式をアップロード（フォルダドラッグ＆ドロップ対応）
  7. アップロードファイルの構造プレビュー表示
  8. STLファイルの3Dプレビュー表示
  9. 下書き保存/公開選択
  10. プレビュー確認
  11. 公開設定（非公開/公開）

- **記事表示ページ**
  - クリーンで読みやすいレイアウト
  - 記事内容の表示（テキスト、画像、動画）
  - STLファイルの3Dプレビュー表示
  - 記事とは別に、制作用ファイル一式のダウンロードセクション
  - ファイル一式のダウンロードボタン（明確に区別されたUI）
  - ファイル構造のプレビュー
  - 著者情報表示
  - SNSシェアボタン
  - **モバイル対応**
    - 記事閲覧のレスポンシブデザイン
    - モバイルでのファイル選択最適化
    - 軽量化された3Dモデルビューア（モバイル向け）
    - 画像・動画のプログレッシブ読み込み

- **ファイル管理機能**
  - フォルダ構造を維持したアップロード
  - STLファイル必須バリデーション
  - 危険なファイル形式の排除
  - ファイル構造の視覚的表示
  - 一括ダウンロード機能
  - ファイルサイズ制限（記事メディア：10MB/ファイル、制作ファイル：100MB/記事）
  - ユーザーごとの容量制限（初期：500MB、将来的に拡張プラン検討）
  - 大容量ファイルの処理（圧縮、リサイズ、分割アップロード）

## 🛠️ 技術スタック

- **フロントエンド**
  - リッチテキストエディタ：TipTap
  - 記事内メディアアップロード：Supabase Storage（article_mediaテーブル）
  - ファイル一式アップロード：Supabase Storage（filesテーブル、別バケット）
  - 3Dモデルビューア：Three.js
  - コンテンツ区分表示：タブまたはセクション分けによる明確なUI区分
  - ファイル構造表示：カスタムツリービューコンポーネント
  - フォルダアップロード：webkitdirectory + ドラッグ＆ドロップAPI

- **バックエンド**
  - Supabase RLSによるアクセス制御
  - Next.js Server Actionsによるデータ処理
  - ファイルバリデーションとセキュリティチェック

## ⏱️ 実装スケジュール

- **フェーズ1：基本機能実装（10日）**
  - データベース設計と作成
  - リッチテキストエディタ実装
  - 基本的な記事投稿・表示機能
  - シンプルなファイルアップロード機能

- **フェーズ2：ファイル管理機能実装（7日）**
  - フォルダ構造を維持したアップロード
  - ファイル構造プレビュー
  - STLファイル必須バリデーション
  - STLファイルプレビュー機能

- **フェーズ3：メディア機能実装（5日）**
  - 画像・動画アップロード・埋め込み
  - 下書き・公開機能

- **フェーズ4：UI/UX改善（5日）**
  - デザイン調整
  - レスポンシブ対応
  - ユーザビリティテスト
  - パフォーマンス最適化

## 📊 期待される効果

- ユーザー滞在時間の増加（30%以上）
- コンテンツ多様化によるSEO効果向上
- クリエイターコミュニティの活性化
- 知識共有による3D制作の普及促進
- サイト全体のエンゲージメント向上
- ダウンロード計測によるコンテンツ価値の可視化
- SNSでの拡散効果によるオーガニックユーザー獲得
- 「カタマリ発」のクリエイター育成とブランディング
- 3Dプリント市場全体の活性化と裾野拡大
- 初心者の参入障壁低減と3Dプリント技術の普及
- 日本語コンテンツの充実による国内市場拡大
- ニッチなアイデアや技術の保存・継承

## 🛡️ 法的要件と運用ポリシー

- **著作権と利用規約**
  - アップロードコンテンツのライセンスオプション（著作権保持、CCライセンスなど）
  - 制作ファイルの利用許諾範囲の明確化
  - 利用規約への同意プロセス
  - 商用利用・非商用利用の区分明示

- **コンテンツモデレーション**
  - 不適切コンテンツの報告機能
  - 著作権侵害対応ポリシー
  - アップロードファイルの安全性チェック
  - コミュニティガイドラインの策定と運用

- **記事管理機能**
  - 記事の編集は最新版のみを保持（履歴なし）
  - ファイル更新は再アップロードによる上書き処理
  - 記事とファイルの関連付けをIDベースで維持

## 🔮 将来的な拡張性

- **コミュニティ機能の強化**
  - コメント・フィードバック機能
  - いいね・お気に入り機能
  - フォロー機能とフィード表示

- **ガバナンス・評価システム**
  - コンテンツ評価とランキング
  - 優良クリエイター認定制度
  - レビュー・フィードバックシステム

- **教育・学習機能**
  - 段階的な学習パスの提供
  - チャレンジ・コンテスト機能
  - グループ・チーム制作のサポート 